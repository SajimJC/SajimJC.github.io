<!-- start custom footer snippets -->

<a href="/sitemap/">Sitemap</a>

<!-- Support for MatJax -->
<script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script"></script>

<!-- Support for Mermaid -->
<script>
  const loadScript = (src) =>
    new Promise((resolve, reject) => {
      const script = document.createElement('script');
      script.src = src;
      script.onload = resolve;
      script.onerror = reject;
      document.head.appendChild(script);
    });

  const setupMermaid = () => {
    const mermaidCodeBlocks = document.querySelectorAll('pre > code.language-mermaid');
    const mermaidTypes = /(graph|flowchart|sequenceDiagram|classDiagram|stateDiagram|erDiagram|journey|gantt|pie|timeline|mindmap|quadrantChart|xychart|requirementDiagram|c4Diagram)\b/i;
    mermaidCodeBlocks.forEach((code) => {
      const text = code.textContent.trim();
      if (!text || !mermaidTypes.test(text)) {
        return;
      }
      const pre = code.parentElement;
      const container = document.createElement('div');
      container.className = 'mermaid';
      container.textContent = text;
      pre.replaceWith(container);
    });
    mermaid.initialize({ startOnLoad: true, theme: 'default' });
  };

  loadScript('https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.min.js')
    .catch(() => loadScript('{{ base_path }}/assets/js/mermaid.min.js'))
    .then(setupMermaid);
</script>

<!-- end custom footer snippets -->
